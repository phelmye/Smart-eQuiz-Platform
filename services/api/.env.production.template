# ===========================
# PRODUCTION ENVIRONMENT VARIABLES
# ===========================
# Last Updated: November 23, 2025
# 
# SECURITY WARNING: Never commit this file with real values!
# This is a template. Copy to .env.production and fill in real values.
# Generate secrets with: openssl rand -base64 64
#
# ===========================

# ===========================
# DATABASE CONFIGURATION
# ===========================
# Supabase connection (with connection pooling for serverless)
DATABASE_URL="postgresql://postgres.xxxxx:[PASSWORD]@aws-0-us-west-1.pooler.supabase.com:5432/postgres?pgbouncer=true&connection_limit=1"

# Direct connection for migrations (bypasses pooler)
DIRECT_DATABASE_URL="postgresql://postgres.xxxxx:[PASSWORD]@aws-0-us-west-1.pooler.supabase.com:5432/postgres"

# Alternative: Neon Database
# DATABASE_URL="postgresql://user:password@ep-xxx.us-east-2.aws.neon.tech/neondb?sslmode=require"

# Alternative: Railway Database
# DATABASE_URL="postgresql://user:password@containers-us-west-xxx.railway.app:7432/railway"

# ===========================
# REDIS CONFIGURATION
# ===========================
# Upstash Redis (recommended for serverless)
UPSTASH_REDIS_REST_URL="https://xxxxx.upstash.io"
UPSTASH_REDIS_REST_TOKEN="AxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxQ"

# Traditional Redis URL (if not using Upstash REST API)
REDIS_URL="redis://default:password@xxxxx.upstash.io:6379"

# Alternative: Redis Cloud
# REDIS_URL="redis://default:password@redis-12345.c123.us-east-1-2.ec2.cloud.redislabs.com:12345"

# ===========================
# JWT SECRETS (CRITICAL!)
# ===========================
# MUST be strong random strings (64+ characters)
# Generate new secrets with: openssl rand -base64 64
# NEVER use the example values below!
JWT_SECRET="REPLACE_WITH_STRONG_RANDOM_STRING_64_CHARS_MINIMUM"
JWT_REFRESH_SECRET="REPLACE_WITH_DIFFERENT_STRONG_RANDOM_STRING_64_CHARS_MINIMUM"

# Token expiry times
JWT_EXPIRES_IN="15m"
JWT_REFRESH_EXPIRES_IN="7d"

# ===========================
# SERVER CONFIGURATION
# ===========================
NODE_ENV="production"
PORT="3000"
API_URL="https://api.smartequiz.com"

# Frontend URLs (for CORS configuration)
MARKETING_SITE_URL="https://www.smartequiz.com"
PLATFORM_ADMIN_URL="https://admin.smartequiz.com"
TENANT_APP_BASE_URL="https://smartequiz.com"

# CORS allowed origins (comma-separated)
# Use specific domains in production, not wildcards
CORS_ORIGINS="https://www.smartequiz.com,https://admin.smartequiz.com,https://*.smartequiz.com"

# ===========================
# STRIPE PAYMENT INTEGRATION
# ===========================
# Get from https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY="sk_live_REPLACE_WITH_YOUR_STRIPE_SECRET_KEY"
STRIPE_PUBLISHABLE_KEY="pk_live_REPLACE_WITH_YOUR_STRIPE_PUBLISHABLE_KEY"

# Webhook secret (for verifying Stripe events)
# Get from https://dashboard.stripe.com/webhooks
STRIPE_WEBHOOK_SECRET="whsec_REPLACE_WITH_YOUR_STRIPE_WEBHOOK_SECRET"

# Subscription Product IDs (create in Stripe dashboard)
STRIPE_STARTER_PRICE_ID="price_REPLACE_WITH_YOUR_PRICE_ID"
STRIPE_PROFESSIONAL_PRICE_ID="price_REPLACE_WITH_YOUR_PRICE_ID"
STRIPE_ENTERPRISE_PRICE_ID="price_REPLACE_WITH_YOUR_PRICE_ID"

# ===========================
# EMAIL SERVICE (SendGrid)
# ===========================
# Get from https://app.sendgrid.com/settings/api_keys
SENDGRID_API_KEY="SG.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
SENDGRID_FROM_EMAIL="noreply@smartequiz.com"
SENDGRID_FROM_NAME="Smart eQuiz Platform"

# Dynamic template IDs (create in SendGrid)
SENDGRID_WELCOME_TEMPLATE_ID="d-xxxxxxxxxxxxxxxxxxxxx"
SENDGRID_RESET_PASSWORD_TEMPLATE_ID="d-xxxxxxxxxxxxxxxxxxxxx"
SENDGRID_TOURNAMENT_INVITE_TEMPLATE_ID="d-xxxxxxxxxxxxxxxxxxxxx"
SENDGRID_INVOICE_TEMPLATE_ID="d-xxxxxxxxxxxxxxxxxxxxx"

# ===========================
# SMS SERVICE (Twilio) - Optional
# ===========================
# Get from https://console.twilio.com
TWILIO_ACCOUNT_SID="ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
TWILIO_AUTH_TOKEN="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
TWILIO_PHONE_NUMBER="+12345678900"

# ===========================
# AI QUESTION GENERATION
# ===========================
# OpenAI API (primary)
# Get from https://platform.openai.com/api-keys
OPENAI_API_KEY="sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
OPENAI_MODEL="gpt-4"
OPENAI_MAX_TOKENS="2000"
OPENAI_TEMPERATURE="0.7"

# Alternative: Anthropic Claude
# ANTHROPIC_API_KEY="sk-ant-xxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
# ANTHROPIC_MODEL="claude-3-opus-20240229"

# ===========================
# MEDIA STORAGE (Cloudinary)
# ===========================
# Get from https://console.cloudinary.com
CLOUDINARY_CLOUD_NAME="smart-equiz"
CLOUDINARY_API_KEY="xxxxxxxxxxxxxxxxxxxxx"
CLOUDINARY_API_SECRET="xxxxxxxxxxxxxxxxxxxxx"

# Upload configuration
MAX_FILE_SIZE_MB="10"
ALLOWED_FILE_TYPES="image/jpeg,image/png,image/webp,application/pdf"

# ===========================
# MONITORING & LOGGING
# ===========================
# Sentry Error Tracking
# Get from https://sentry.io/settings/projects/
SENTRY_DSN="https://xxxxxxxxxxxxxxxxxxxxxxxxxxxxx@o123456.ingest.sentry.io/123456"
SENTRY_ENVIRONMENT="production"
SENTRY_RELEASE="smart-equiz-api@2.0.0"
SENTRY_TRACES_SAMPLE_RATE="1.0"

# DataDog APM (optional)
# DATADOG_API_KEY="xxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
# DATADOG_APP_KEY="xxxxxxxxxxxxxxxxxxxxxxxxxxxxx"

# LogRocket (optional)
# LOGROCKET_APP_ID="smart-equiz/production"

# ===========================
# RATE LIMITING
# ===========================
# Public endpoints (unauthenticated)
RATE_LIMIT_PUBLIC="100"              # 100 requests per window
RATE_LIMIT_PUBLIC_WINDOW_MS="3600000"  # 1 hour

# Authenticated endpoints
RATE_LIMIT_AUTHENTICATED="1000"      # 1000 requests per window
RATE_LIMIT_AUTHENTICATED_WINDOW_MS="3600000"  # 1 hour

# Auth endpoints (stricter limit)
RATE_LIMIT_AUTH="5"                  # 5 requests per window
RATE_LIMIT_AUTH_WINDOW_MS="300000"   # 5 minutes

# ===========================
# SECURITY
# ===========================
# Encryption key for sensitive data (32 bytes, base64 encoded)
# Generate with: openssl rand -base64 32
ENCRYPTION_KEY="REPLACE_WITH_32_BYTE_BASE64_ENCODED_KEY"

# Session secret (64+ characters)
# Generate with: openssl rand -base64 64
SESSION_SECRET="REPLACE_WITH_STRONG_SESSION_SECRET"
SESSION_MAX_AGE="604800000"  # 7 days in milliseconds

# CORS configuration
CORS_CREDENTIALS="true"
CORS_MAX_AGE="86400"  # 24 hours

# Security headers
HSTS_MAX_AGE="31536000"  # 1 year
HSTS_INCLUDE_SUBDOMAINS="true"
HSTS_PRELOAD="true"

# ===========================
# FEATURE FLAGS
# ===========================
# Enable/disable features globally
ENABLE_AI_GENERATION="true"
ENABLE_REFERRAL_SYSTEM="true"
ENABLE_SWAGGER_DOCS="false"      # Disable in production for security
ENABLE_DEBUG_LOGS="false"
ENABLE_PROFILING="false"

# Beta features
ENABLE_VIDEO_TUTORIALS="false"
ENABLE_LIVE_STREAMING="false"

# ===========================
# BACKUP & MAINTENANCE
# ===========================
# Automated backup configuration
BACKUP_ENABLED="true"
BACKUP_SCHEDULE="0 2 * * *"      # Daily at 2 AM UTC (cron format)
BACKUP_RETENTION_DAYS="30"

# AWS S3 for backup storage
AWS_ACCESS_KEY_ID="AKIAxxxxxxxxxxxxx"
AWS_SECRET_ACCESS_KEY="xxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
AWS_REGION="us-east-1"
AWS_BACKUP_BUCKET="smart-equiz-backups"

# Alternative: Cloudflare R2
# R2_ACCOUNT_ID="xxxxxxxxxxxxxxxxxxxxx"
# R2_ACCESS_KEY_ID="xxxxxxxxxxxxxxxxxxxxx"
# R2_SECRET_ACCESS_KEY="xxxxxxxxxxxxxxxxxxxxx"
# R2_BUCKET_NAME="smart-equiz-backups"

# ===========================
# PERFORMANCE
# ===========================
# Database connection pool
DATABASE_POOL_MIN="2"
DATABASE_POOL_MAX="10"
DATABASE_QUERY_TIMEOUT="30000"   # 30 seconds

# Redis connection pool
REDIS_POOL_MIN="2"
REDIS_POOL_MAX="20"
REDIS_COMMAND_TIMEOUT="5000"     # 5 seconds

# Cache TTL (time-to-live in seconds)
CACHE_TTL_SHORT="300"            # 5 minutes
CACHE_TTL_MEDIUM="1800"          # 30 minutes
CACHE_TTL_LONG="86400"           # 24 hours

# Request timeout
REQUEST_TIMEOUT="60000"          # 60 seconds

# ===========================
# EXTERNAL SERVICES
# ===========================
# Currency exchange rates API
# Get from https://exchangerate-api.com
EXCHANGE_RATE_API_KEY="xxxxxxxxxxxxxxxxxxxxx"

# Geolocation service (optional)
# IPSTACK_API_KEY="xxxxxxxxxxxxxxxxxxxxx"

# ===========================
# WEBHOOKS
# ===========================
# Webhook endpoints for external notifications
WEBHOOK_TOURNAMENT_COMPLETED="https://your-service.com/webhooks/tournament-completed"
WEBHOOK_PAYMENT_RECEIVED="https://your-service.com/webhooks/payment-received"

# ===========================
# ANALYTICS
# ===========================
# Google Analytics (optional)
GA_TRACKING_ID="G-XXXXXXXXXX"

# Mixpanel (optional)
MIXPANEL_TOKEN="xxxxxxxxxxxxxxxxxxxxx"

# ===========================
# TENANT DEFAULTS
# ===========================
# Default values for new tenant creation
DEFAULT_TENANT_PLAN="starter"
DEFAULT_TENANT_CURRENCY="USD"
DEFAULT_TENANT_LOCALE="en"
DEFAULT_TENANT_TIMEZONE="America/New_York"

# Trial period configuration
TRIAL_PERIOD_DAYS="14"
TRIAL_REQUIRES_PAYMENT="false"

# ===========================
# NOTIFICATIONS
# ===========================
# Admin notification emails (comma-separated)
ADMIN_NOTIFICATION_EMAILS="admin@smartequiz.com,support@smartequiz.com"

# Notification channels
ENABLE_EMAIL_NOTIFICATIONS="true"
ENABLE_SMS_NOTIFICATIONS="false"
ENABLE_PUSH_NOTIFICATIONS="false"

# ===========================
# COMPLIANCE
# ===========================
# GDPR configuration
GDPR_ENABLED="true"
DATA_RETENTION_DAYS="730"  # 2 years

# Cookie consent
COOKIE_CONSENT_REQUIRED="true"

# ===========================
# DEVELOPMENT/DEBUGGING
# ===========================
# Set to false in production
DEBUG="false"
VERBOSE_LOGGING="false"

# Prisma logging
# Options: query, info, warn, error
DATABASE_LOG_LEVEL="warn,error"

# ===========================
# DEPLOYMENT METADATA
# ===========================
# Deployment tracking
DEPLOY_ENV="production"
DEPLOY_VERSION="2.0.0"
DEPLOY_TIMESTAMP="2025-11-23T00:00:00Z"
DEPLOY_COMMIT_SHA="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
